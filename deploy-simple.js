const { ethers } = require('ethers');

async function deployContracts() {
  console.log('üöÄ Iniciando deployment...');
  
  const provider = new ethers.JsonRpcProvider('http://localhost:7545');
  const deployer = new ethers.Wallet('0x4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d', provider);
  
  console.log('Deployer:', deployer.address);
  console.log('Balance:', ethers.formatEther(await provider.getBalance(deployer.address)));
  
  // 1. Transferir ETH a tu cuenta
  console.log('\nüí∞ Transfiriendo ETH a tu cuenta...');
  const ethTx = await deployer.sendTransaction({
    to: '0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E',
    value: ethers.parseEther('50'),
    gasLimit: 21000
  });
  await ethTx.wait();
  console.log('‚úÖ 50 ETH transferidos');
  
  // 2. Desplegar MockUSDT
  console.log('\nüèóÔ∏è  Desplegando MockUSDT...');
  const MockUSDT = await ethers.getContractFactory([
    'constructor(string memory name, string memory symbol)',
    'function mint(address to, uint256 amount) public',
    'function transfer(address to, uint256 amount) public returns (bool)',
    'function balanceOf(address account) public view returns (uint256)',
    'function approve(address spender, uint256 amount) public returns (bool)'
  ], '0x608060405234801561001057600080fd5b506040516107b03803806107b083398101604081905261002f9161007c565b81516100429060039060208501906100ed565b5080516100569060049060208401906100ed565b50505061011f565b634e487b7160e01b600052604160045260246000fd5b80516001600160401b038116811461007757600080fd5b919050565b6000806040838503121561008f57600080fd5b82516001600160401b03808211156100a657600080fd5b818501915085601f8301126100ba57600080fd5b81518181111156100cc576100cc61005f565b604051601f8201601f19908116603f011681019083821181831017156100f4576100f461005f565b8160405282815260209350888484870101111561011057600080fd5b600091505b82821015610132578482018401518183018501529083019061011557565b82821115610144576000848401525b9690950151949194509250505050565b828054610160906101ae565b90600052602060002090601f016020900481019282610182576000855561018e565b82601f1061019b57805160ff191683800117855561018e565b8280016001018555821561018e579182015b828111156101ae5782518255916020019190600101906101ad565b5061018e9291506101ce565b600181811c908216806101c257607f821691505b602082108114156101e357634e487b7160e01b600052602260045260246000fd5b50919050565b5b808211156101ff576000815560010161016f565b5090565b61068280610212000396000f3fe608060405234801561001057600080fd5b50600436106100885760003560e01c806340c10f191161005b57806340c10f19146100fb57806370a082311461010e57806395d89b4114610137578063a9059cbb1461013f57600080fd5b806306fdde031461008d578063095ea7b3146100ab57806318160ddd146100ce57806323b872dd146100e8575b600080fd5b610095610152565b6040516100a291906104f1565b60405180910390f35b6100be6100b9366004610562565b6101e4565b60405190151581526020016100a2565b6100d760025481565b6040519081526020016100a2565b6100be6100f636600461058c565b6101fe565b6100be610109366004610562565b610268565b6100d761011c3660046105c8565b6001600160a01b031660009081526020819052604090205490565b610095610276565b6100be61014d366004610562565b610285565b606060038054610161906105ea565b80601f016020809104026020016040519081016040528092919081815260200182805461018d906105ea565b80156101da5780601f106101af576101008083540402835291602001916101da565b820191906000526020600020905b8154815290600101906020018083116101bd57829003601f168201915b5050505050905090565b6000336101f2818585610292565b60019150505b92915050565b600061020b8484846103b6565b61025e843361025985604051806060016040528060288152602001610625602891396001600160a01b038a1660009081526001602090815260408083203384529091529020549190610585565b610292565b5060019392505050565b6000610274833461058c565b61027d610285565b6100be61014d366004610562565b505090565b606060048054610161906105ea565b60006102928383836103b6565b6001600160a01b0383166102f45760405162461bcd60e51b8152602060048201526024808201527f45524332303a20617070726f76652066726f6d20746865207a65726f206164646044820152637265737360e01b60648201526084015b60405180910390fd5b6001600160a01b0382166103555760405162461bcd60e51b815260206004820152602260248201527f45524332303a20617070726f766520746f20746865207a65726f206164647265604482015261737360f01b60648201526084016102eb565b6001600160a01b0383811660008181526001602090815260408083209487168084529482529182902085905590518481527f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92591015b60405180910390a3505050565b6001600160a01b0383166104195760405162461bcd60e51b815260206004820152602560248201527f45524332303a207472616e736665722066726f6d20746865207a65726f206164604482015264647265737360d81b60648201526084016102eb565b6001600160a01b03821661047b5760405162461bcd60e51b815260206004820152602360248201527f45524332303a207472616e7366657220746f20746865207a65726f206164647260448201526265737360e81b60648201526084016102eb565b61048881600061058c565b6001600160a01b038416600090815260208190526040902054818110156105005760405162461bcd60e51b815260206004820152602660248201527f45524332303a207472616e7366657220616d6f756e7420657863656564732062604482015265616c616e636560d01b60648201526084016102eb565b6001600160a01b03808616600090815260208190526040808220858503905591861681529081208054849290610537908490610640565b92505081905550836001600160a01b0316856001600160a01b03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8560405161029a91815260200190565b6000818484111561057c5760405162461bcd60e51b81526004016102eb91906104f1565b505050900390565b600061059883836105a0565b949350505050565b6000826105af576105b08385610658565b6105b9565b6105b98385610677565b949350505050565b6000602082840312156105da57600080fd5b81356001600160a01b03811681146105f157600080fd5b9392505050565b600181811c9082168061060c57607f821691505b6020821081141561062d57634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052601160045260246000fd5b6000821982111561065357610653610633565b500190565b60008282101561066a5761066a610633565b500390565b600081600019048311821515161561069157610691610633565b50029056fe45524332303a207472616e7366657220616d6f756e74206578636565647320616c6c6f77616e636500000000000000000000000000000000000000000000000000000000', deployer);
  
  const mockUSDT = await MockUSDT.deploy('Mock USDT', 'USDT');
  await mockUSDT.waitForDeployment();
  const tokenAddress = await mockUSDT.getAddress();
  console.log('‚úÖ MockUSDT desplegado en:', tokenAddress);
  
  // 3. Mintear tokens para tu cuenta
  console.log('\nü™ô  Minteando tokens...');
  const mintTx = await mockUSDT.mint('0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E', ethers.parseUnits('10000', 18));
  await mintTx.wait();
  console.log('‚úÖ 10,000 USDT minteados');
  
  console.log('\n=== RESUMEN FINAL ===');
  console.log('MockUSDT:', tokenAddress);
  console.log('Tu direcci√≥n:', '0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E');
  console.log('ETH Balance:', ethers.formatEther(await provider.getBalance('0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E')));
  console.log('USDT Balance:', ethers.formatUnits(await mockUSDT.balanceOf('0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E'), 18));
  console.log('==================');
}

deployContracts().catch(console.error);