const { ethers } = require('ethers');

const provider = new ethers.JsonRpcProvider('http://localhost:7545');
const deployer = new ethers.Wallet('0x4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d', provider);

// Contrato USDT simple
const abi = [
  "constructor()",
  "function balanceOf(address) view returns (uint256)",
  "function transfer(address to, uint256 amount) returns (bool)",
  "function approve(address spender, uint256 amount) returns (bool)",
  "function mint(address to, uint256 amount)",
  "function name() view returns (string)",
  "function symbol() view returns (string)",
  "function decimals() view returns (uint8)"
];

const bytecode = "0x608060405234801561001057600080fd5b506040518060400160405280600981526020016804d6f636b20555344545560bc1b8152506000908152602081905260409020600181018290558060025561005333600a61006660201b60201c565b61006064746a52880061006660201b60201c565b5050610128565b6001600160a01b0382166100865760405163ec442f0560e01b815260040160405180910390fd5b806002600082825461009891906100e7565b90915550506001600160a01b038216600090815260208190526040812080548392906100c59084906100e7565b90915550506040518181526000906001600160a01b038416907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9060200160405180910390a35050565b60008219821115610100576101006100fa565b634e487b7160e01b600052601160045260246000fd5b5b500190565b610536806101376000396000f3fe608060405234801561001057600080fd5b50600436106100935760003560e01c806340c10f191161006657806340c10f19146100fc57806370a082311461011157806395d89b4114610134578063a9059cbb1461013c578063dd62ed3e1461014f57600080fd5b806306fdde0314610098578063095ea7b3146100b657806318160ddd146100d957806323b872dd146100e8575b600080fd5b6100a0610188565b6040516100ad9190610447565b60405180910390f35b6100c96100c43660046104b8565b6101ba565b60405190151581526020016100ad565b6100db60025481565b6040519081526020016100ad565b6100c96100f63660046104e2565b6101d1565b61010f61010a3660046104b8565b610235565b005b6100db61011f36600461051e565b6001600160a01b031660009081526020819052604090205490565b6100a0610243565b6100c961014a3660046104b8565b610250565b6100db61015d366004610540565b6001600160a01b03918216600090815260016020908152604080832093909416825291909152205490565b6060600380546101979061056d565b80601f01602080910402602001604051908101604052809291908181526020018280546101c39061056d565b80156101d05780601f106101e5576101008083540402835291602001916101d0565b820191906000526020600020905b8154815290600101906020018083116101f357829003601f168201915b5050505050905090565b600061020433848461025d565b61023184336102f785604051806060016040528060288152602001610519602891396001600160a01b038a1660009081526001602090815260408083203384529091529020549190610381565b61025d565b5060019392505050565b61023f82826103bb565b5050565b6060600480546101979061056d565b600061020433848461041b565b6001600160a01b0383166102bf5760405162461bcd60e51b8152602060048201526024808201527f45524332303a20617070726f76652066726f6d20746865207a65726f206164646044820152637265737360e01b60648201526084015b60405180910390fd5b6001600160a01b0382166103205760405162461bcd60e51b815260206004820152602260248201527f45524332303a20617070726f766520746f20746865207a65726f206164647265604482015261737360f01b60648201526084016102b6565b6001600160a01b0383811660008181526001602090815260408083209487168084529482529182902085905590518481527f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925910160405180910390a3505050565b600081848411156103a55760405162461bcd60e51b81526004016102b69190610447565b50600061037b84866105a8565b949350505050565b6001600160a01b0382166103e15760405163ec442f0560e01b815260040160405180910390fd5b8060026000828254610394919061035e565b90915550506001600160a01b038216600090815260208190526040812080548392906103c0908490610590565b90915550506040518181526000906001600160a01b038416907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9060200160405180910390a35050565b6001600160a01b03831661047f5760405162461bcd60e51b815260206004820152602560248201527f45524332303a207472616e736665722066726f6d20746865207a65726f206164604482015264647265737360d81b60648201526084016102b6565b6001600160a01b0382166104e15760405162461bcd60e51b815260206004820152602360248201527f45524332303a207472616e7366657220746f20746865207a65726f206164647260448201526265737360e81b60648201526084016102b6565b6001600160a01b038316600090815260208190526040902054818110156105595760405162461bcd60e51b815260206004820152602660248201527f45524332303a207472616e7366657220616d6f756e7420657863656564732062604482015265616c616e636560d01b60648201526084016102b6565b6001600160a01b03808516600090815260208190526040808220858503905591851681529081208054849290610410908490610590565b92505081905550836001600160a01b0316856001600160a01b03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8560405161045991815260200190565b60405180910390a350505050565b600060208083528351808285015260005b8181101561047457858101830151858201604001528201610458565b81811115610486576000604083870101525b50601f01601f1916929092016040019392505050565b80356001600160a01b03811681146104b357600080fd5b919050565b600080604083850312156104cb57600080fd5b6104d48361049c565b946020939093013593505050565b6000806000606084860312156104f757600080fd5b6105008461049c565b925061050e6020850161049c565b9150604084013590509250925092565b60006020828403121561053057600080fd5b6105398261049c565b9392505050565b6000806040838503121561055357600080fd5b61055c8361049c565b915061056a6020840161049c565b90509250929050565b600181811c9082168061058757607f821691505b602082108114156105a857634e487b7160e01b600052602260045260246000fd5b50919050565b6000828210156105c0576105c06105aa565b500390565b634e487b7160e01b600052601160045260246000fd5b6000821982111561055c576105c56105c0565b50019056fe45524332303a207472616e7366657220616d6f756e74206578636565647320616c6c6f77616e636500000000000000000000000000000000000000000000000000a2646970667358221220000000000000000000000000000000000000000000000000000000000000000064736f6c634300080f0033";

async function main() {
  try {
    console.log('Deploying USDT...');
    
    const factory = new ethers.ContractFactory(abi, bytecode, deployer);
    const contract = await factory.deploy({
      gasLimit: 3000000
    });
    
    await contract.waitForDeployment();
    const address = await contract.getAddress();
    
    console.log('USDT deployed at:', address);
    
    // Mint tokens
    const mintTx = await contract.mint('0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E', ethers.parseUnits('50000', 18));
    await mintTx.wait();
    
    const balance = await contract.balanceOf('0x03A4CCf306B0a22175b7781f24F95Fa5cdBE634E');
    console.log('Balance:', ethers.formatUnits(balance, 18));
    console.log('SUCCESS! Contract at:', address);
  } catch (error) {
    console.error('Error:', error.message);
  }
}

main();